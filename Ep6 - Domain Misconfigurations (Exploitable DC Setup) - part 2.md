# ADCS ESC1 Certificate Template Setup  
*Active Directory Certificate Services must be installed on LAB-DC*

This guide walks you through creating a vulnerable certificate template that can be used to demonstrate ESC1 abuse in a lab environment.

---

## Step 1: Open Certificate Template Console

On `LAB-DC`, press `Win + R`  
Type `certtmpl.msc` and hit **Enter**

This opens the Certificate Templates management console.

---

## Step 2: Duplicate the “User” Template

- Locate the **User** template in the list  
- Right-click it → select **Duplicate Template**
- When prompted, choose **Windows Server 2003** compatibility  
- Click **OK**

---

## Step 3: Configure the New Template

You are now editing the duplicated certificate template. Make the following changes:

### General Tab
- **Template display name:** `ESC1Template`  
- **Template name:** *(auto-generated)*

### Security Tab
- Click **Add** → type `Domain Users` → click **OK**
- Select **Domain Users**, then check:
  - **Enroll**
  - **Autoenroll**

### Request Handling Tab
- Check **Allow private key to be exported**  
*(Optional but commonly abused in real-world attacks)*

### Subject Name Tab
- Select **Supply in the request**
- Uncheck **Build from this Active Directory information**

### Extensions Tab
- Under **Application Policies**, ensure **Client Authentication** is listed
- If missing:
  - Click **Edit**
  - Click **Add** → select **Client Authentication** → **OK**

When finished, click **Apply**, then **OK** to close the template settings.

---

## Step 4: Publish the Template

Open the Certification Authority console:

- Press `Win + R`, type `certsrv.msc`, and hit **Enter**
- In the left panel, expand your CA
- Right-click **Certificate Templates** → **New** → **Certificate Template to Issue**
- From the list, select `ESC1Template`
- Click **OK**

---

The template is now published and can be requested — setting the stage for ESC1 exploitation.
